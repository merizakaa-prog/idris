<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ø±ÙØ¹ Ø§Ù„Ø£Ø·Ø¨Ø§Ù‚</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <style>
        :root { --main: #8b0000; --green: #2ecc71; }
        body { font-family: 'Tahoma', sans-serif; background: #f4f4f4; padding: 20px; direction: rtl; }
        .admin-container { max-width: 500px; margin: auto; background: #fff; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: var(--main); }
        label { display: block; margin-top: 15px; font-weight: bold; font-size: 14px; }
        input, select, textarea { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; background: var(--green); color: white; margin-top: 20px; font-size: 16px; }
        button:disabled { background: #ccc; }
        #status { text-align: center; margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>

<div class="admin-container">
    <h2>â• Ø¥Ø¶Ø§ÙØ© Ø·Ø¨Ù‚ Ø¬Ø¯ÙŠØ¯</h2>
    
    <label>Ø§Ù„Ù‚Ø³Ù…:</label>
    <select id="itemCategory">
        <option value="Ø·Ø¹Ø§Ù…">Ø·Ø¹Ø§Ù… ğŸ½ï¸</option>
        <option value="Ù…Ø´Ø±ÙˆØ¨Ø§Øª">Ù…Ø´Ø±ÙˆØ¨Ø§Øª ğŸ¥¤</option>
        <option value="ØªØ­Ù„ÙŠØ©">ØªØ­Ù„ÙŠØ© ğŸ°</option>
        <option value="Ù‚Ø§Ø·Ùˆ">Ù‚Ø§Ø·Ùˆ ğŸª</option>
    </select>

    <input type="text" id="itemName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø¨Ù‚">
    <input type="number" id="itemPrice" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ø¯Ø¬)">
    
    <label>ØµÙˆØ±Ø© Ø§Ù„Ø·Ø¨Ù‚:</label>
    <input type="file" id="fileImg" accept="image/*">

    <label>ÙÙŠØ¯ÙŠÙˆ Ù‚ØµÙŠØ± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
    <input type="file" id="fileVideo" accept="video/*">

    <textarea id="itemIngredients" placeholder="Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª (Ø§ÙØµÙ„ Ø¨ÙŠÙ†Ù‡Ø§ Ø¨ÙØ§ØµÙ„Ø© ,)"></textarea>
    <textarea id="itemBenefits" placeholder="Ø§Ù„ÙÙˆØ§Ø¦Ø¯ (Ø§ÙØµÙ„ Ø¨ÙŠÙ†Ù‡Ø§ Ø¨ÙØ§ØµÙ„Ø© ,)"></textarea>

    <button id="submitBtn" onclick="handleUpload()">Ø­ÙØ¸ ÙˆÙ†Ø´Ø± Ø§Ù„Ø·Ø¨Ù‚ âœ…</button>
    <p id="status"></p>
</div>

<script>
const firebaseConfig = {
    apiKey: "YOUR_API_KEY", // Ø§Ø³ØªØ¨Ø¯Ù„ Ø¨Ù€ API Key Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªÙˆÙØ±Ø§Ù‹
    authDomain: "restaurant-e323a.firebaseapp.com",
    projectId: "restaurant-e323a",
    storageBucket: "restaurant-e323a.appspot.com",
    messagingSenderId: "309092455734",
    appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Cloudinary
const CLOUD_NAME = "dzrrirfig";
const PRESET = "restaurant_preset";

async function uploadToCloudinary(file) {
    const formData = new FormData();
    formData.append("file", file);
    formData.append("upload_preset", PRESET);
    
    // Ø§Ø³ØªØ®Ø¯Ø§Ù… "auto" ÙŠØ³Ù…Ø­ Ø¨Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    const response = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/auto/upload`, {
        method: "POST",
        body: formData
    });
    const data = await response.json();
    if (!data.secure_url) throw new Error(data.error.message);
    return data.secure_url;
}

async function handleUpload() {
    const status = document.getElementById('status');
    const btn = document.getElementById('submitBtn');
    const imgFile = document.getElementById('fileImg').files[0];
    const videoFile = document.getElementById('fileVideo').files[0];

    if (!document.getElementById('itemName').value || !imgFile) {
        alert("Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ØµÙˆØ±Ø© Ø¶Ø±ÙˆØ±ÙŠØ§Ù†!"); return;
    }

    btn.disabled = true;
    status.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹... ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±";
    status.style.color = "orange";

    try {
        const imgUrl = await uploadToCloudinary(imgFile);
        let videoUrl = videoFile ? await uploadToCloudinary(videoFile) : "";

        await db.collection("products").add({
            name: document.getElementById('itemName').value,
            price: document.getElementById('itemPrice').value,
            category: document.getElementById('itemCategory').value,
            img: imgUrl,
            video: videoUrl,
            ingredients: document.getElementById('itemIngredients').value.split(',').map(s => s.trim()),
            benefits: document.getElementById('itemBenefits').value.split(',').map(s => s.trim()),
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        status.innerText = "âœ… ØªÙ… Ø¨Ù†Ø¬Ø§Ø­!";
        status.style.color = "green";
        document.querySelectorAll('input, textarea').forEach(i => i.value = "");
    } catch (e) {
        status.innerText = "âŒ Ø®Ø·Ø£: " + e.message;
        status.style.color = "red";
    } finally {
        btn.disabled = false;
    }
}
</script>
</body>
</html>
