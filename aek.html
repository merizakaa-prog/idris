<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ø¹Ø§Ù… Ø§Ù„Ø°ÙƒÙŠØ©</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
    <style>
        :root { --main-color: #8b0000; --bg-gray: #f4f4f4; }
        body { margin:0; font-family: 'Tahoma', sans-serif; background: var(--bg-gray); color: #333; overflow-x: hidden; }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .category-bar {
            display:flex; overflow-x: auto; white-space: nowrap;
            padding:15px; background:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.1); 
            position:sticky; top:0; z-index:100; gap: 10px; scrollbar-width: none;
        }
        .category-bar::-webkit-scrollbar { display: none; }

        .cat {
            min-width:85px; height:85px; background:#fff; border-radius:15px;
            display:inline-flex; flex-direction:column; align-items:center; justify-content:center;
            cursor:pointer; transition: 0.3s; border: 1px solid #eee; flex-shrink: 0;
        }
        .cat span { font-size:13px; margin-top:5px; font-weight: bold; }
        .cat.active { background: var(--main-color); color:white; transform: scale(1.05); }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .container { padding:20px; }
        .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:15px; }

        .card {
            background:#fff; border-radius:20px; padding:10px; text-align:center;
            box-shadow:0 8px 15px rgba(0,0,0,0.05); transition:.3s; cursor:pointer;
        }
        .card:active { transform: scale(0.95); }
        .card img { width:100%; height:130px; object-fit: cover; border-radius:15px; }
        .card h3 { margin:8px 0; font-size:15px; }
        .card p { color: var(--main-color); font-weight: bold; margin:0; font-size: 14px; }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ (Ø§Ù„Ù…ÙˆØ¯Ø§Ù„) */
        .modal {
            position:fixed; inset:0; background:rgba(0,0,0,0.8);
            display:none; justify-content:center; align-items:center; z-index:1000; padding: 15px;
        }
        .modal.show { display:flex; }
        .modal-box {
            background:#fff; width:100%; max-width:400px; border-radius:25px;
            padding:20px; max-height: 90vh; overflow-y: auto; position: relative;
        }
        video { width:100%; border-radius:15px; background:#000; margin-bottom: 10px; }
        
        /* Ø§Ù„Ø³Ù„Ø© */
        .cart-btn {
            position:fixed; bottom:20px; left:20px; background: var(--main-color);
            color:white; padding:12px 20px; border-radius:50px; z-index:500;
            box-shadow: 0 5px 15px rgba(139,0,0,0.3); border: none; font-weight: bold;
        }
    </style>
</head>
<body>

<div class="category-bar">
    <div class="cat active" onclick="fetchMenu('Ø·Ø¹Ø§Ù…', this)">ğŸ½ï¸<span>Ø·Ø¹Ø§Ù…</span></div>
    <div class="cat" onclick="fetchMenu('Ù…Ø´Ø±ÙˆØ¨Ø§Øª', this)">ğŸ¥¤<span>Ù…Ø´Ø±ÙˆØ¨Ø§Øª</span></div>
    <div class="cat" onclick="fetchMenu('ØªØ­Ù„ÙŠØ©', this)">ğŸ°<span>ØªØ­Ù„ÙŠØ©</span></div>
    <div class="cat" onclick="fetchMenu('Ù‚Ø§Ø·Ùˆ', this)">ğŸª<span>Ù‚Ø§Ø·Ùˆ</span></div>
</div>

<div class="container">
    <div id="grid" class="grid"></div>
</div>

<div class="modal" id="modal">
    <div class="modal-box">
        <video id="video" controls></video>
        <h3 id="title" style="color:var(--main-color); margin-bottom:5px;"></h3>
        <p id="modalPrice" style="font-weight:bold; margin-bottom:15px;"></p>
        
        <div style="text-align: right; font-size: 14px;">
            <b>ğŸ§¾ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª:</b>
            <ul id="ingredients" style="padding-right: 20px;"></ul>
            <b>ğŸ’ª Ø§Ù„ÙÙˆØ§Ø¦Ø¯:</b>
            <ul id="benefits" style="padding-right: 20px;"></ul>
        </div>

        <button id="addBtn" style="width:100%; padding:12px; border-radius:12px; border:none; color:white; font-weight:bold; margin-top:10px;" onclick="addToCart()"></button>
        <button style="width:100%; padding:10px; margin-top:10px; background:#eee; border:none; border-radius:12px;" onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<button class="cart-btn" onclick="alert('Ø³ÙŠØªÙ… ÙØªØ­ Ø§Ù„Ø³Ù„Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹!')">ğŸ›’ Ø§Ù„Ø³Ù„Ø© (<span id="cartCount">0</span>)</button>

<script>
// --- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase (ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù†ÙØ³ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØµÙØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©) ---
const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "restaurant-e323a.firebaseapp.com",
    projectId: "restaurant-e323a",
    storageBucket: "restaurant-e323a.appspot.com",
    messagingSenderId: "309092455734",
    appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let currentItem = null;
let cart = [];

// Ø¯Ø§Ù„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firestore
function fetchMenu(category, element) {
    // ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù„Ù„Ø£Ø²Ø±Ø§Ø±
    document.querySelectorAll('.cat').forEach(c => c.classList.remove('active'));
    element.classList.add('active');

    const grid = document.getElementById('grid');
    grid.innerHTML = "<p style='grid-column: 1/-1;'>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>";

    // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© "products" Ø­Ø³Ø¨ Ø§Ù„Ù‚Ø³Ù…
    db.collection("products").where("category", "==", category).get().then(snap => {
        grid.innerHTML = "";
        if(snap.empty) {
            grid.innerHTML = "<p style='grid-column: 1/-1;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø·Ø¨Ø§Ù‚ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø­Ø§Ù„ÙŠØ§Ù‹.</p>";
            return;
        }
        snap.forEach(doc => {
            const data = doc.data();
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => openModal(data);
            card.innerHTML = `
                <img src="${data.img || 'https://via.placeholder.com/150'}">
                <h3>${data.name}</h3>
                <p>${data.price} Ø¯Ø¬</p>
            `;
            grid.appendChild(card);
        });
    });
}

function openModal(item) {
    currentItem = item;
    document.getElementById('modal').classList.add('show');
    document.getElementById('title').innerText = item.name;
    document.getElementById('modalPrice').innerText = "Ø§Ù„Ø³Ø¹Ø±: " + item.price + " Ø¯Ø¬";
    
    // Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    const video = document.getElementById('video');
    if(item.video) {
        video.src = item.video;
        video.style.display = "block";
    } else {
        video.style.display = "none";
    }

    // Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… (Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ÙˆØ§Ù„ÙÙˆØ§Ø¦Ø¯)
    document.getElementById('ingredients').innerHTML = (item.ingredients || []).map(i => `<li>${i}</li>`).join('') || "ØºÙŠØ± Ù…ØªÙˆÙØ±";
    document.getElementById('benefits').innerHTML = (item.benefits || []).map(b => `<li>${b}</li>`).join('') || "ØºÙŠØ± Ù…ØªÙˆÙØ±";

    updateButtonState();
}

function closeModal() {
    document.getElementById('modal').classList.remove('show');
    document.getElementById('video').pause();
}

function addToCart() {
    const index = cart.findIndex(i => i.name === currentItem.name);
    if(index === -1) {
        cart.push(currentItem);
    } else {
        cart.splice(index, 1);
    }
    document.getElementById('cartCount').innerText = cart.length;
    updateButtonState();
}

function updateButtonState() {
    const btn = document.getElementById('addBtn');
    const isInCart = cart.some(i => i.name === currentItem.name);
    btn.innerText = isInCart ? "Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø³Ù„Ø© âœ–" : "Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø·Ù„Ø¨ ğŸ›’";
    btn.style.background = isInCart ? "#ff4444" : "#2ecc71";
}

// Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
window.onload = () => fetchMenu('Ø·Ø¹Ø§Ù…', document.querySelector('.cat'));
</script>

</body>
</html>
