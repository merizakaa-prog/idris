<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <style>
        /* --- ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© --- */
        .video-container {
            position: relative;
            width: 100%;
            height: 250px;
            background: #000;
            border-radius: 25px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        /* Ø¬Ø¹Ù„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠÙ…Ù„Ø£ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø¨Ø´ÙƒÙ„ Ù…ØªÙ†Ø§Ø³Ù‚ */
        video#dishVideo {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ù„Ø¶Ù…Ø§Ù† Ù…Ù„Ø¡ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø«Ù„ ØªÙŠÙƒ ØªÙˆÙƒ */
            display: block;
        }

        /* Ø·Ø¨Ù‚Ø© ØªØ¸Ù„ÙŠÙ„ Ø¬Ù…Ø§Ù„ÙŠØ© ÙÙˆÙ‚ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
        .video-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.3) 0%, transparent 40%, rgba(0,0,0,0.5) 100%);
            pointer-events: none; /* Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù†ÙØ³Ù‡ */
            z-index: 1;
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© ØªØ´ØºÙŠÙ„ ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        .play-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(139, 0, 0, 0.85);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            z-index: 2;
            animation: pulse 2s infinite;
            cursor: pointer;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(139, 0, 0, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(139, 0, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(139, 0, 0, 0); }
        }

        /* Ø¥Ø®ÙØ§Ø¡ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¨Ù…Ø¬Ø±Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
        .video-playing .play-hint, 
        .video-playing .video-overlay {
            opacity: 0;
            visibility: hidden;
            transition: 0.5s;
        }

        /* ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
        .content-panel {
            border-radius: 35px 35px 0 0 !important;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>

<div class="overlay" id="dishOverlay">
    <div class="content-panel">
        <i class="fa-solid fa-circle-xmark close-icon" onclick="closeModal('dishOverlay')" 
           style="top: -15px; left: 50%; transform: translateX(-50%); font-size: 35px; color: #fff; background: var(--main); border-radius: 50%;"></i>
        
        <div class="video-container" id="vidCont">
            <div class="video-overlay"></div>
            <div class="play-hint" id="playHint"><i class="fas fa-play"></i></div>
            
            <video id="dishVideo" 
                   playsinline 
                   preload="metadata"
                   onclick="togglePlay()">
            </video>
        </div>

        <h2 id="dishName" style="margin:10px 0; text-align: center;"></h2>
        <p id="dishPrice" style="color:var(--main); font-weight:900; font-size:26px; text-align: center;"></p>
        
        <div class="details-box">
            <div id="dishIng"></div>
            <div id="dishBen" style="margin-top:8px; color: var(--accent); font-weight: 600;"></div>
        </div>

        <button id="addBtn" class="btn-main" onclick="handleCartAction()" style="background:var(--main); color:#fff; border-radius: 20px;">
            <span id="addBtnText">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø·Ù„Ø¨ ğŸ›’</span>
            <div class="spinner" id="addSpinner"></div>
        </button>
    </div>
</div>

<script>
// --- Ù†ÙØ³ Ø¯Ø§Ù„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ---

function openModal(item) {
    currentItem = item;
    document.getElementById('dishName').innerText = item.name;
    document.getElementById('dishPrice').innerText = item.price + " Ø¯Ø¬";
    
    const v = document.getElementById('dishVideo');
    const cont = document.getElementById('vidCont');
    
    // 1. Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø´ÙƒÙ„ Ø§Ù„Ø­Ø§ÙˆÙŠØ©
    cont.classList.remove('video-playing');
    
    // 2. Ø¶Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµÙˆØ±Ø© ÙƒØºÙ„Ø§Ù Poster)
    v.src = item.video || "";
    v.poster = item.img || ""; // ØªØ¸Ù‡Ø± Ø§Ù„ØµÙˆØ±Ø© ÙƒØ®Ù„ÙÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„Ù„ÙÙŠØ¯ÙŠÙˆ
    v.load(); 

    // 3. Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ÙˆØ§Ù„ÙÙˆØ§Ø¦Ø¯
    const ingredients = Array.isArray(item.ingredients) ? item.ingredients.join('ØŒ ') : (item.ingredients || 'Ø·Ø¨ÙŠØ¹ÙŠØ©');
    const benefits = Array.isArray(item.benefits) ? item.benefits.join('ØŒ ') : (item.benefits || 'ØµØ­ÙŠØ© ÙˆØºÙ†ÙŠØ©');
    document.getElementById('dishIng').innerHTML = `<i class="fas fa-leaf"></i> <b>Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª:</b> ${ingredients}`;
    document.getElementById('dishBen').innerHTML = `<i class="fas fa-star"></i> <b>Ø§Ù„ÙÙˆØ§Ø¦Ø¯:</b> ${benefits}`;

    // 4. ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø±
    const isInCart = cart.some(i => i.name === item.name);
    document.getElementById('addBtnText').innerText = isInCart ? "Ø¥Ø²Ø§Ù„Ø© Ù…Ù† Ø§Ù„Ø·Ù„Ø¨ âŒ" : "Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø·Ù„Ø¨ ğŸ›’";
    
    document.getElementById('dishOverlay').classList.add('show');
}

// Ø¯Ø§Ù„Ø© Ù„ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„ÙŠÙ‡
function togglePlay() {
    const v = document.getElementById('dishVideo');
    const cont = document.getElementById('vidCont');
    
    if (v.paused) {
        v.play();
        cont.classList.add('video-playing');
    } else {
        v.pause();
        cont.classList.remove('video-playing');
    }
}

function closeModal(id) {
    document.getElementById(id).classList.remove('show');
    const v = document.getElementById('dishVideo');
    v.pause();
    v.currentTime = 0; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
}

// ... (Ø¨Ø§Ù‚ÙŠ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©) ...
</script>
</body>
</html>
